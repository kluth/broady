<div class="studio-container">
  <header class="studio-header">
    <h1>{{ title }}</h1>
    <div class="header-actions">
      <button class="btn-header">File</button>
      <button class="btn-header">View</button>
      <button class="btn-header">Help</button>
    </div>
  </header>

  <div class="studio-content">
    <!-- Preview Area -->
    <div class="preview-area">
      <streaming-video-preview></streaming-video-preview>

      <!-- Alerts Display Overlay -->
      <div class="preview-overlay">
        <streaming-alerts-system></streaming-alerts-system>
      </div>
    </div>

    <!-- Side Panel with Tabs -->
    <aside class="side-panel">
      <!-- Tab Navigation -->
      <nav class="panel-tabs">
        <button
          class="tab-btn"
          [class.active]="activeTab() === 'sources'"
          (click)="activeTab.set('sources')">
          üìã Sources
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab() === 'overlays'"
          (click)="activeTab.set('overlays')">
          üé® Overlays
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab() === 'multistream'"
          (click)="activeTab.set('multistream')">
          üåê Multi-Stream
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab() === 'chat'"
          (click)="activeTab.set('chat')">
          üí¨ Chat
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab() === 'alerts'"
          (click)="activeTab.set('alerts')">
          üîî Alerts
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab() === 'stats'"
          (click)="activeTab.set('stats')">
          üìä Stats
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab() === 'cloud'"
          (click)="activeTab.set('cloud')">
          ‚òÅÔ∏è Cloud
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab() === 'ai'"
          (click)="activeTab.set('ai')">
          ü§ñ AI
        </button>
        <button
          class="tab-btn"
          [class.active]="activeTab() === 'music'"
          (click)="activeTab.set('music')">
          üéµ Music
        </button>
      </nav>

      <!-- Tab Content -->
      <div class="panel-content">
        @if (activeTab() === 'sources') {
          <section class="panel-section">
            <streaming-scene-list></streaming-scene-list>
          </section>
          <section class="panel-section">
            <streaming-sources-manager></streaming-sources-manager>
          </section>
          <section class="panel-section">
            <streaming-audio-mixer></streaming-audio-mixer>
          </section>
        }

        @if (activeTab() === 'overlays') {
          <section class="panel-section full-height">
            <streaming-overlays-manager></streaming-overlays-manager>
          </section>
        }

        @if (activeTab() === 'multistream') {
          <section class="panel-section full-height">
            <streaming-multistream></streaming-multistream>
          </section>
        }

        @if (activeTab() === 'chat') {
          <section class="panel-section full-height">
            <streaming-chat-integration></streaming-chat-integration>
          </section>
        }

        @if (activeTab() === 'alerts') {
          <section class="panel-section full-height">
            <streaming-alerts-system></streaming-alerts-system>
          </section>
        }

        @if (activeTab() === 'stats') {
          <section class="panel-section full-height">
            <streaming-stats-dashboard></streaming-stats-dashboard>
          </section>
        }

        @if (activeTab() === 'cloud') {
          <section class="panel-section full-height">
            <streaming-cloud-sync></streaming-cloud-sync>
            @if (isCloudConnected()) {
              <div class="cloud-status">
                <p>‚òÅÔ∏è Connected as {{ currentUser()?.displayName }}</p>
                <p class="cloud-info">Your scenes and configs are automatically synced</p>
              </div>
            }
          </section>
        }

        @if (activeTab() === 'ai') {
          <section class="panel-section full-height">
            <div class="ai-panel">
              <h3>ü§ñ AI Assistant</h3>
              @if (isAIConfigured()) {
                <div class="ai-feature">
                  <h4>Auto Captions</h4>
                  <p>Real-time speech-to-text for your stream</p>
                  <button class="btn-ai">Enable Captions</button>
                </div>
                <div class="ai-feature">
                  <h4>Scene Suggestions</h4>
                  <p>Get AI-powered scene recommendations</p>
                  <button class="btn-ai">Get Suggestions</button>
                </div>
                <div class="ai-feature">
                  <h4>Chat Moderation</h4>
                  <p>AI-powered content filtering</p>
                  <button class="btn-ai">Configure Moderation</button>
                </div>
              } @else {
                <div class="ai-setup">
                  <p>Configure AI provider to unlock features</p>
                  <button class="btn-setup">Setup AI</button>
                </div>
              }
            </div>
          </section>
        }

        @if (activeTab() === 'music') {
          <section class="panel-section full-height">
            <div class="music-panel">
              <h3>üéµ Royalty-Free Music</h3>
              @if (currentTrack()) {
                <div class="now-playing">
                  <p class="track-title">{{ currentTrack()!.title }}</p>
                  <p class="track-artist">{{ currentTrack()!.artist }}</p>
                  <div class="playback-controls">
                    @if (isPlaying()) {
                      <button class="btn-play" (click)="music.pause()">‚è∏Ô∏è Pause</button>
                    } @else {
                      <button class="btn-play" (click)="music.play(currentTrack()!)">‚ñ∂Ô∏è Play</button>
                    }
                  </div>
                </div>
              }
              <div class="music-library">
                <h4>Music Library</h4>
                <p>Browse {{ music.allTracks().length }} royalty-free tracks</p>
                <div class="music-stats">
                  <p>Genres: {{ music.genres().length }}</p>
                  <p>Moods: {{ music.moods().length }}</p>
                </div>
                <button class="btn-browse">Browse Music</button>
                <button class="btn-browse">Create Playlist</button>
              </div>
            </div>
          </section>
        }
      </div>
    </aside>
  </div>

  <!-- Bottom Control Bar -->
  <footer class="studio-footer">
    <streaming-controls></streaming-controls>
  </footer>
</div>

<!-- Settings Dialog -->
<streaming-settings-dialog></streaming-settings-dialog>

<router-outlet></router-outlet>
