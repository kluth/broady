<div class="ai-dashboard">
  <div class="dashboard-header">
    <h3>ü§ñ AI Features</h3>
    @if (isConfigured()) {
      <span class="status-badge configured">Configured - {{ providerName() }}</span>
    } @else {
      <span class="status-badge not-configured">Not Configured</span>
    }
  </div>

  <div class="tabs">
    <button class="tab" [class.active]="selectedTab() === 'config'" (click)="selectTab('config')">
      ‚öôÔ∏è Config
    </button>
    <button class="tab" [class.active]="selectedTab() === 'recommendations'" (click)="selectTab('recommendations')">
      üí° Scenes
    </button>
    <button class="tab" [class.active]="selectedTab() === 'titles'" (click)="selectTab('titles')">
      üìù Titles
    </button>
    <button class="tab" [class.active]="selectedTab() === 'captions'" (click)="selectTab('captions')">
      üìÑ Captions
    </button>
    <button class="tab" [class.active]="selectedTab() === 'enhancement'" (click)="selectTab('enhancement')">
      üéµ Audio
    </button>
  </div>

  <div class="tab-content">
    @if (selectedTab() === 'config') {
      <div class="config-panel">
        <h4>AI Provider Configuration</h4>

        <div class="provider-selection">
          @for (provider of providers; track provider) {
            <button
              class="provider-btn"
              [class.active]="selectedProvider() === provider"
              (click)="updateProvider(provider)"
            >
              @if (provider === 'gemini') {
                <span class="provider-icon">‚ú®</span>
                <span class="provider-name">Google Gemini</span>
                <span class="provider-desc">Fast, multimodal AI</span>
              }
              @if (provider === 'openai') {
                <span class="provider-icon">üîÆ</span>
                <span class="provider-name">OpenAI</span>
                <span class="provider-desc">GPT-4 & Whisper</span>
              }
              @if (provider === 'claude') {
                <span class="provider-icon">üß†</span>
                <span class="provider-name">Claude</span>
                <span class="provider-desc">Thoughtful analysis</span>
              }
            </button>
          }
        </div>

        <div class="api-key-section">
          <label>API Key</label>
          <input
            type="password"
            [value]="apiKey()"
            (input)="updateApiKey($any($event.target).value)"
            placeholder="Enter your API key..."
            class="api-key-input"
          />
          <button class="btn-save" (click)="saveConfiguration()" [disabled]="!apiKey()">
            Save Configuration
          </button>
        </div>

        <div class="capabilities">
          <h5>Capabilities</h5>
          <div class="capability-list">
            @for (cap of aiService.capabilities(); track cap) {
              <span class="capability-badge">{{ cap }}</span>
            }
          </div>
        </div>
      </div>
    }

    @if (selectedTab() === 'recommendations') {
      <div class="recommendations-panel">
        <div class="panel-header">
          <h4>AI Scene Recommendations</h4>
          <button
            class="btn-generate"
            (click)="getRecommendations()"
            [disabled]="!isConfigured() || aiService.isProcessing()"
          >
            @if (aiService.isProcessing()) {
              <span class="spinner"></span> Generating...
            } @else {
              Get Recommendations
            }
          </button>
        </div>

        @if (recommendations().length > 0) {
          <div class="recommendations-list">
            @for (rec of recommendations(); track rec.sceneName) {
              <div class="recommendation-card">
                <div class="rec-header">
                  <h5>{{ rec.sceneName }}</h5>
                  <span class="confidence" [class]="getConfidenceClass(rec.confidence)">
                    {{ (rec.confidence * 100).toFixed(0) }}% match
                  </span>
                </div>
                <p class="rec-reason">{{ rec.reason }}</p>
                <div class="rec-sources">
                  <strong>Suggested sources:</strong>
                  <div class="source-tags">
                    @for (source of rec.suggestedSources; track source) {
                      <span class="source-tag">{{ source }}</span>
                    }
                  </div>
                </div>
                <button class="btn-implement" (click)="implementRecommendation(rec)">
                  Create Scene
                </button>
              </div>
            }
          </div>
        } @else {
          <div class="empty-state">
            <p>Click "Get Recommendations" to receive AI-powered scene suggestions!</p>
          </div>
        }
      </div>
    }

    @if (selectedTab() === 'titles') {
      <div class="titles-panel">
        <div class="panel-header">
          <h4>AI Stream Title Generator</h4>
        </div>

        <div class="title-context">
          <div class="input-group">
            <label>Game/Content</label>
            <input
              type="text"
              [value]="game()"
              (input)="updateGame($any($event.target).value)"
              placeholder="e.g., Valorant, Just Chatting"
            />
          </div>
          <div class="input-group">
            <label>Category</label>
            <input
              type="text"
              [value]="category()"
              (input)="updateCategory($any($event.target).value)"
              placeholder="e.g., Gaming, Music, Art"
            />
          </div>
          <div class="input-group">
            <label>Mood</label>
            <input
              type="text"
              [value]="mood()"
              (input)="updateMood($any($event.target).value)"
              placeholder="e.g., Chill, Energetic, Competitive"
            />
          </div>
        </div>

        <button
          class="btn-generate"
          (click)="generateTitles()"
          [disabled]="!isConfigured() || aiService.isProcessing()"
        >
          @if (aiService.isProcessing()) {
            <span class="spinner"></span> Generating...
          } @else {
            Generate Titles
          }
        </button>

        @if (titleSuggestions().length > 0) {
          <div class="title-suggestions">
            @for (title of titleSuggestions(); track $index) {
              <div class="title-card">
                <span class="title-text">{{ title }}</span>
                <button class="btn-copy" (click)="copyTitle(title)">üìã Copy</button>
              </div>
            }
          </div>
        }
      </div>
    }

    @if (selectedTab() === 'captions') {
      <div class="captions-panel">
        <div class="panel-header">
          <h4>Auto-Generate Captions</h4>
          <button
            class="btn-generate"
            (click)="generateCaptions()"
            [disabled]="!isConfigured() || aiService.isProcessing()"
          >
            @if (aiService.isProcessing()) {
              <span class="spinner"></span> Processing...
            } @else {
              Generate Captions
            }
          </button>
        </div>

        @if (captions().length > 0) {
          <div class="captions-list">
            @for (caption of captions(); track caption.start) {
              <div class="caption-item">
                <div class="caption-time">
                  {{ formatTime(caption.start) }} - {{ formatTime(caption.end) }}
                </div>
                <div class="caption-text">{{ caption.text }}</div>
                <div class="caption-confidence">
                  Confidence: {{ (caption.confidence * 100).toFixed(1) }}%
                </div>
              </div>
            }
          </div>
          <button class="btn-apply" (click)="applyCaptions()">
            Apply Captions
          </button>
        } @else {
          <div class="empty-state">
            <p>Generate captions from your audio/video content!</p>
          </div>
        }
      </div>
    }

    @if (selectedTab() === 'enhancement') {
      <div class="enhancement-panel">
        <div class="panel-header">
          <h4>AI Audio Enhancement</h4>
        </div>

        <div class="enhancement-options">
          <label class="checkbox-option">
            <input type="checkbox" checked />
            <span>Noise Reduction</span>
          </label>
          <label class="checkbox-option">
            <input type="checkbox" checked />
            <span>Volume Normalization</span>
          </label>
          <label class="checkbox-option">
            <input type="checkbox" />
            <span>Voice Enhancement</span>
          </label>
        </div>

        <button class="btn-enhance" [disabled]="!isConfigured()">
          Enhance Audio
        </button>

        <div class="info-box">
          <strong>üí° Pro Tip:</strong> AI audio enhancement can remove background noise,
          normalize volume levels, and enhance voice clarity for professional sound quality.
        </div>
      </div>
    }
  </div>
</div>
